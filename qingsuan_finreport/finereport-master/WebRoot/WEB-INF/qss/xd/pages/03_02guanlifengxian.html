<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="shortcut icon" href="${contextPath}/static/img/com/logo.png">
    <link rel="stylesheet" href="${contextPath}/static/asserts/css/normalize.css">
    <link rel="stylesheet" href="${contextPath}/static/css/style.css">
    <link rel="stylesheet" href="${contextPath}/static/css/pageCom.css">
    <style>
        .pageBody{
            display: flex;
            flex: 1;
        }
        .left{
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        .left>div{
            flex: 1;
        }
        .right{
            flex: 2;
        }
         #test thead tr th{
         	background: #00abde;
            width: 20%;
            text-align: center;
            padding: .5rem 0rem;
            font-size:0.8rem;

        }
        {
            width: 20%;
            text-align: center;
            padding: .5rem 0;
            font-size:0.8rem;
        }
       
    </style>
</head>
<body id="03_02guanlifengxian" data-title="管理风险">
<div class="container">
    <h2 hidden>管理风险</h2>
    <header class="pageHeader">
        <div class="inputGroup">
            <label for="pingtai">平台：</label>
            <div class="mySelect" id="pingtai">
                <div class="myOption selected"><span class="text"></span><span class="icon"></span></div>
                <ul class="myOptionBox">
                               ##for(j in jys!){
                                <li id="${j.jyscmc!}" onclick=changeJysData(this) class="myOption">${j.jyscmc!}</li>                
                               ##}
                               
                </ul>
            </div>
        </div>
    </header>
    <div class="pageBody">
        <div class="left">
            <div class="left-top">
                <div class="chartBox ec001">
                    <div class="chartTitle">
                        <h3>高管资质(银行信贷从业年限占比)</h3>
                    </div>
                    <div class="chartContent">
                        <div class="chartBody">
                            <div id="ec001_currentCompetitiveness"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="left-bottom">
                <div class="chartBox ec002">
                    <div class="chartTitle">
                        <h3>职工资质(员工学历占比)</h3>
                    </div>
                    <div class="chartContent">
                        <header></header>
                        <div class="chartBody">
                            <div id="ec002_competitivenessIndicators"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="right">
            <div class="chartBox ec002">
                <div class="chartTitle">
                    <h3>管理风险列示</h3>
                </div>
                <div class="chartContent">
                    <table id="test">
                        <thead>
                        <tr><th>报警时间</th><th>预警指标</th><th>预警原因</th><th>平台名称</th><th>业务详述</th></tr>
                        </thead>
                        <tbody>
                         ##for(risk in show!){
                        <tr><td id="td1">${risk.bjsj!}</td><td id="td2">${risk.fxlb!}</td><td id="td3">${risk.fxzb!}</td><td id="td4">${risk.jgmc!}</td><td class="more"><a href=""> 查看</a></td></tr>
                         ##}
            
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>

</div>

<script src="${contextPath}/static/asserts/js/echarts-4.0.js"></script>
<script src="${contextPath}/static/asserts/js/jquery-2.2.4.js"></script>
<script src="${contextPath}/static/js/pageCom.js"></script>
<script src="${contextPath}/static/js/chartsCom.js"></script>
<script>

var jysCode;
//切换交易所 刷新全部数据
 function changeJysData(obj){
	//获取交易所现在下拉选择值
	jysCode=$(obj).attr("id");
	initData();
 }
 //加载全部数据 
function initData(){
	//加载圆饼比例 
	getsenior();
	//加载管理风险警示列表 
	getshow();
}
    var allCharts = [];

    
    function getsenior(){
    	
    	 var ec001 = echarts.init($("#ec001_currentCompetitiveness")[0]);
         ec001.setOption(opt_pie);
         ec001.setOption({
             label: {
                 color: '#fff',
                 normal: {
                     position: 'outer'
                 }
             },
             series : [
                 {
                     name:'高管资质',
                     type:'pie',
                     radius : '60%',
                     center: ['36%', '50%'],
                     data : (function(){
                     	
                 	             var arr=[];
                 	             $.ajax({
                 	                 type : "post",
                 	                  async : false, //同步执行
                 	                   url : "${contextPath}/qdch/managementrisk/gainSenior",
                 	                   data : {"jys":jysCode},
                 	                   dataType : "json", //返回数据形式为json
                 	                   success : function(result) {
                 	                	   
                 	                	   
                 	                	   $.each(result,function(index,item){
                 	                		   arr.push({
                    	                            name : item.cynx,
                    	                            value : item.fvalue
                    	                         }); 
                 	                	   })
                 	                 
              
                 	                 },
                 	                 error : function(errorMsg) {
                 	                          alert("不好意思,图表请求数据失败啦!");
                 	                           myChart.hideLoading();
                 	                         }
                 	                 })
                 	                   return arr;
                 	                })() 


                 }
             ]
         });
       
         var ec002 = echarts.init($("#ec002_competitivenessIndicators")[0]);
         ec002.setOption(opt_pie);
         ec002.setOption({
             label: {
                 color: '#fff',
                 normal: {
                     position: 'outer'
                 }
             },
             series : [
                 {
                     name:'职工资质 ',
                     type:'pie',
                     radius : '60%',
                     center: ['36%', '50%'],
                     data : (function(){
        	             var arr=[];
        	             $.ajax({
        	                 type : "post",
        	                  async : false, //同步执行
        	                   url : "${contextPath}/qdch/managementrisk/gainEduction",
        	                   data : {"jys":jysCode},
        	                   dataType : "json", //返回数据形式为json
        	                   success : function(result) {
        	                	   
        	                	   
        	                	   $.each(result,function(index,item){
        	                		   arr.push({
           	                            name : item.xuel,
           	                            value : item.fvalue
           	                         }); 
        	                	   })
        	                 
     
        	                 },
        	                 error : function(errorMsg) {
        	                          alert("不好意思,图表请求数据失败啦!");
        	                           myChart.hideLoading();
        	                         }
        	                 })
        	                   return arr;
        	                })() 


                 }
             ]
         });

         //本页所有图表
         allCharts = [ec001, ec002];
    }
    
      function getshow(){
       $.post("${contextPath}/qdch/managementrisk/gainShow",{"jys":jysCode},function(data){
       $("#test tbody").html("");	
          var tr=[];
    	  $.each(data,function(index,item){
    		var mTr='';
    		mTr+='<tr><td>'+item.bjsj+'</td><td>'+item.fxlb+'</td><td>'+item.fxzb+'</td><td>'+item.jgmc+'<td class="more"><a href=""> 查看</a></td></tr>';
    		tr.push(mTr);
    		
    		  });
    		$("tbody").html(tr.join(''));
    	
    	  })	
      }
      
      
      
    $(function () {
        var ec001 = echarts.init($("#ec001_currentCompetitiveness")[0]);
        ec001.setOption(opt_pie);
        ec001.setOption({
            label: {
                color: '#fff',
                normal: {
                    position: 'outer'
                }
            },
            series : [
                {
                    name:'高管资质',
                    type:'pie',
                    radius : '60%',
                    center: ['36%', '50%'],
                    data : (function(){
                    	
                	             var arr=[];
                	             $.ajax({
                	                 type : "post",
                	                  async : false, //同步执行
                	                   url : "${contextPath}/qdch/managementrisk/gainSenior",
                	                   data : {"jys":jysCode},
                	                   dataType : "json", //返回数据形式为json
                	                   success : function(result) {
                	                	   
                	                	   
                	                	   $.each(result,function(index,item){
                	                		   arr.push({
                   	                            name : item.cynx,
                   	                            value : item.fvalue
                   	                         }); 
                	                	   })
                	                 
             
                	                 },
                	                 error : function(errorMsg) {
                	                          alert("不好意思,图表请求数据失败啦!");
                	                           myChart.hideLoading();
                	                         }
                	                 })
                	                   return arr;
                	                })() 


                }
            ]
        });
      
        var ec002 = echarts.init($("#ec002_competitivenessIndicators")[0]);
        ec002.setOption(opt_pie);
        ec002.setOption({
            label: {
                color: '#fff',
                normal: {
                    position: 'outer'
                }
            },
            series : [
                {
                    name:'职工资质',
                    type:'pie',
                    radius : '60%',
                    center: ['36%', '50%'],
                    data : (function(){
       	             var arr=[];
       	             $.ajax({
       	                 type : "post",
       	                  async : false, //同步执行
       	                   url : "${contextPath}/qdch/managementrisk/gainEduction",
       	                   data : {"jys":jysCode},
       	                   dataType : "json", //返回数据形式为json
       	                   success : function(result) {
       	                	   
       	                	   
       	                	   $.each(result,function(index,item){
       	                		   arr.push({
          	                            name : item.xuel,
          	                            value : item.fvalue
          	                         }); 
       	                	   })
       	                 
    
       	                 },
       	                 error : function(errorMsg) {
       	                          alert("不好意思,图表请求数据失败啦!");
       	                           myChart.hideLoading();
       	                         }
       	                 })
       	                   return arr;
       	                })() 


                }
            ]
        });

        //本页所有图表
        allCharts = [ec001, ec002];
    });


</script>
</body>
</html>
